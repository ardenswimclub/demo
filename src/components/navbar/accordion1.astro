---
import { withBase } from "@/utils/url";

const { menu, menuKey, depth = 0 } = Astro.props;

import { accordionMenu } from "../../data/menus.ts";
const menu2 = menu ?? accordionMenu;
const heading = menu2.heading ?? "";
---

<div
  class="inline-block
  w-screen
  bg-gray-200
  z-100
  border-2 border-blue-400"
>
  <!-- Checkbox Toggle -->
  <input type="checkbox" id={`menu-toggle${depth}`} 
    class={`hidden peer/menu${depth}`} />
  <label for={`menu-toggle${depth}`} 
    class="md:hidden block cursor-pointer bg-red-200">
    {heading}
  </label>
   
  <!-- Mobile Accordion -->
  <ul
    class={`
      overflow-hidden     
      flex flex-col
      px-4 md:hidden 
      max-h-0
      peer-checked/menu${depth}:max-h-64
      transition-all duration-500 ease-in-out`}
  >
    {
      menu2.items.map((item) => (
        <li>
          { item.children ? ( 
            <Astro.self menu={item.children} depth={depth+1} /> 
          ) : (
          <a
            href={withBase(item.path)}
            target={item.blank ? "_blank" : undefined}
            rel={item.blank ? "noopener" : undefined}
            class="flex lg:px-1 my-2 items-center text-gray-600 hover:text-gray-900 
            border-b-3 border-b-transparent hover:border-yellow-400"
          >
            <span>{item.title}</span>
          </a>
          )}
        </li>
      ))
    }
  </ul>
</div>
